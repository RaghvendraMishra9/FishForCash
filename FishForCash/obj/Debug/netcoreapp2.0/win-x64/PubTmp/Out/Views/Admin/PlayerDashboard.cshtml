@model FishForCash.Domain.Player.PlayerModel
@{
    ViewData["Title"] = "Player Dashboard";
    Layout = "_AdminLayout";
}
<style>
    .W-500 {
        width: 600px
    }
</style>

<div class="main-content">
    <div class="alert alert-success " style="display:none" id="success-alert-gamecode">
        <button type="button" class="close" data-dismiss="alert"></button>
        <strong>Success! </strong>
        <label id="alertmsg-gamecode"></label>
    </div>

    <div class="alert alert-danger" style="display:none" id="error-alert-gamecode">
        <button type="button" class="close" data-dismiss="alert"></button>

        <label id="errormsg-gamecode"></label>
    </div>
    <div class="section__content section__content--p30">
        <div class="container-fluid">

            <div class="row">
                <div class="col-md-6">
                    <h3 class="title-1 m-b-25">
                        @Model.FullName (ID: @Model.PLayerId)
                    </h3>


                    <div class="card">
                        <dov class="container-fluid">
                            <div class="row justify-content-center">
                                <div class="col col-sm-4 col-md-4 text-left">
                                    <br>  <h3 class="text-center"></h3>
                                    @if (ViewBag.PlayerImage != null)
                                    {
                                        <img src="@ViewBag.PlayerImage" id="profile-img-tag" class="rounded-circle img-fluid rounded" width="100%" alt="avatar">
                                    }
                                    else
                                    {

                                        <img src="~/img/Default.png" id="profile-img-tag" class="rounded-circle img-fluid rounded" width="100%" alt="avatar">
                                    }

                                    <a class="btn btn-danger btn-block" asp-action="DeletePlayerPhoto" asp-controller="Admin" asp-route-playerId="@Model.PLayerId">Delete Photo</a>
                                </div>
                                <div class="col col-sm-8 col-md-8 text-left">

                                    <table border="0" cellspacing="0" cellpadding="3" align="center" class="table table-lg">

                                        <tbody>
                                            <tr>
                                                <td>
                                                    Joined
                                                </td>
                                                <td>
                                                    @Model.CreatedDateStr
                                                </td>
                                            </tr>


                                            <tr>
                                                <td>
                                                    Prize Payouts
                                                </td>
                                                <td>
                                                    @ViewBag.PrizePayout
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    Cash Payouts
                                                </td>
                                                <td>
                                                    @ViewBag.CashPayout
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    Donated
                                                </td>
                                                <td>
                                                    0
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    Forum Posts
                                                </td>
                                                <td>
                                                    2 <a href="#" class="pull-right">View</a>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    Support Emails
                                                </td>
                                                <td>
                                                    3 <a href="#" class="pull-right">View</a>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </dov>
                    </div>
                    <div class="alert alert-success  mt-3" style="display:none; z-index: 999; height: 75px;" id="success-alert">
                        <button type="button" class="close" data-dismiss="alert"></button>
                        <strong>Success! </strong>
                        <label id="alertmsg"></label>
                        @ViewBag.SuccessMsg
                    </div>


                    <div class="alert alert-danger  mt-3" style="display:none; z-index: 999; height: 75px;" id="error-alert">
                        <button type="button" class="close" data-dismiss="alert"></button>
                        <strong>Error! </strong>
                        <label id="errormsg"></label>
                        @ViewBag.ErrorMsg
                    </div>
                    <form asp-action="UpdatePlayer" asp-controller="Admin">
                        <table class="table table-striped">
                            <tbody>
                                <tr>
                                    <td>
                                        <div align="right">Screen Name:</div>
                                    </td>
                                    <td class="W-500">
                                        @Html.LabelForModel(Model.ScreenName, new { @class = "pl" })
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div align="right">First Name:</div>
                                    </td>
                                    <td class="W-500">
                                        <div class="form-group">
                                            <input asp-for="FirstName" class="form-control" />
                                            <span asp-validation-for="FirstName" class="text-danger"></span>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div align="right">Last Name:</div>
                                    </td>
                                    <td class="W-500">
                                        <input asp-for="LastName" class="form-control" />
                                        <span asp-validation-for="LastName" class="text-danger"></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div align="right">Email:</div>
                                    </td>
                                    <td class="W-500">
                                        @Html.LabelForModel(Model.EmailId, new { @class = "pl ", @id = "emailaddresss" })
                                        <input data-toggle="modal" data-target="#playerupdateEmail" data-whatever="Update email " id="openpopup" type="button" class="btn btn-link" value="Update email address." />
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div align="right">Phone:</div>
                                    </td>
                                    <td class="W-500">
                                        <input asp-for="PhoneNo" class="form-control" />
                                        <span asp-validation-for="PhoneNo" class="text-danger"></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div align="right">Street: </div>
                                    </td>
                                    <td class="W-500">
                                        <input asp-for="Address1" class="form-control" />
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div align="right">Suburb:</div>
                                    </td>
                                    <td class="W-500">
                                        <input asp-for="Address2" class="form-control" />
                                    </td>
                                </tr>
                                <tr>

                                    <td>
                                        <div align="right">City:</div>
                                    </td>
                                    <td class="W-500">
                                        <input asp-for="City" class="form-control" />
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div align="right">Country:</div>
                                    </td>
                                    <td>
                                        @Html.DropDownListFor(m => m.CountryId, null, new { @class = "form-control" })
                                        <span asp-validation-for="CountryId" class="text-danger"></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div align="right">Region:</div>
                                    </td>
                                    <td>
                                        @Html.DropDownListFor(m => m.StateId,
                      new SelectList(""),
                      "",
                      new { @class = "form-control" })
                                        <span asp-validation-for="StateId" class="text-danger"></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div align="right">Occupation:</div>
                                    </td>
                                    <td class="W-500">
                                        <input asp-for="Occupation" class="form-control" />
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right">  Mailing List: </td>
                                    <td class="W-500 custom-checkbox">
                                        <input asp-for="GetUpdateByEmail" class="form-control" style="width: 30px; height: 30px;" />
                                    </td>

                                </tr>
                                <tr>
                                    <td>
                                        <div align="right">Age Group:</div>
                                    </td>
                                    <td>
                                        <input type="hidden" name="age_required" value="Please update Your Age Group">
                                        @Html.DropDownListFor(x => x.AgeGroup, new[]{
                        new SelectListItem(){ Text = "1 - 17 Years" , Value = "1"},
                        new SelectListItem(){ Text = "18 - 24 Years", Value = "2"},
                        new SelectListItem(){ Text = "25 - 34 Years", Value = "3"},
                        new SelectListItem(){ Text = "35 - 49 Years", Value = "4"},
                        new SelectListItem(){ Text = "Over 50 Years", Value = "5"}
                        }, "", new {
                        @class = "form-control" })
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                        <input asp-for="PLayerId" type="hidden">
                                        <input type="submit" value="Update Details" name="action" class="btn btn-secondary btn-block"><p>&nbsp;</p>
                                        <div style="float:right"> <button class="btn btn-danger" id="deleteAccount">Delete Account</button></div>
                                    </td>
                                </tr>


                            </tbody>
                        </table>
                    </form>
                </div>
                <div class="col-md-6">


                    <h3 class="title-2 m-b-25">Gamecode Summary</h3>
                    <div class="card card-pad">
                        <table class="table  table-striped ">
                            <thead>
                                <tr>
                                    <th class="text-center">Times Played </th>
                                    <th class="text-center">Prizes Won </th>
                                    <th class="text-center">Unplayed Codes </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="text-center"><h3> @Model.NoOfTimesPlayed</h3></td>
                                    <td class="text-center"><h3> @Model.NoOftimesWon</h3></td>
                                    <td class="text-center"><h3> <span id="unplayedCodes">@Model.NotUsedGameCodes</span></h3></td>
                                </tr>
                            </tbody>
                        </table>
                        <table class="table  table-striped ">
                            <thead>
                                <tr class="text-center">
                                    <th>Product</th>
                                    <th>Smudged</th>
                                    <th>Replaced</th>
                                    <th>Comp</th>
                                    <th>BootySwap</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="text-center"><h3> 92</h3></td>
                                    <td class="text-center"><h3> @ViewBag.SmudgedCount</h3></td>
                                    <td class="text-center"><h3> @Model.ReplacedGameCodesCount</h3></td>
                                    <td class="text-center"><h3> <span id="CompGameCodesCount">@Model.CompGameCodesCount</span></h3></td>
                                    <td class="text-center"><h3> 8</h3></td>
                                </tr>
                            </tbody>
                        </table>
                        <br>
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-md-5 text-center">
                                    <select name="gamecodecount" id="gamecodecount" class="form-control">
                                        <option value="" selected="">--Select number--</option>
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                    </select>
                                </div>
                                <div class="col-md-7 text-center">
                                    <input type="submit" id="generateGameCode" class="btn btn-secondary btn-block" value="Generate Free Gamecodes">
                                </div>
                            </div>
                        </div>
                    </div>
                    <h3 class="title-2 m-b-25">Bank Summary</h3>
                    <div class="card">
                        <table class="table  ">
                            <thead>
                                <tr class="text-center">
                                    <th>Cash Balance</th>
                                    <th>Prize Balance</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="text-center"><h3> @ViewBag.CashAmount</h3></td>
                                    <td class="text-center"><h3> @ViewBag.PrizeAmount</h3></td>
                                </tr>
                            </tbody>
                        </table>
                       
                        <table class="table">
                            <tbody>
                                <tr>
                                    <td>
                                        <select name="cash_amount" class="form-control">
                                            <option value="" selected="">--Update Cash--</option>
                                            <option value="-10.00">-$10.00</option>
                                            <option value="-5.00">-$5.00</option>
                                            <option value="-2.50">-$2.50</option>
                                            <option value="-.50">-$.50</option>
                                            <option value=".50">$.50</option>
                                            <option value="2.50">$2.50</option>
                                            <option value="5.00" selected="">$5.00</option>
                                            <option value="10.00">$10.00</option>
                                        </select>
                                        <input type="submit" class="btn btn-secondary btn-block" value="UPDATE CASH">
                                    </td>
                                    <td>
                                        <select name="cash_amount" class="form-control">
                                            <option value="" selected="">--Update Cash--</option>
                                            <option value="-10.00">-$10.00</option>
                                            <option value="-5.00">-$5.00</option>
                                            <option value="-2.50">-$2.50</option>
                                            <option value="-.50">-$.50</option>
                                            <option value=".50">$.50</option>
                                            <option value="2.50">$2.50</option>
                                            <option value="5.00" selected="">$5.00</option>
                                            <option value="10.00">$10.00</option>
                                        </select>
                                        <input type="submit" class="btn btn-secondary btn-block" value="UPDATE PRIZE">
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <table class="table ">

                            <thead>
                                @*<tr class="text-center">
                                    <th>Prize Payouts</th>
                                    <th>Cash Payouts</th>

                                </tr>*@
                               
                                <tr class="text-center">
                                    @foreach (var item in Model.cashPrizePayouts)
                                    {
                                        <th>@item.PrizeType</th>
                                    }
                                    </tr>
                                
                            </thead>
                            <tbody>
                                @if (Model.cashPrizePayouts.Count > 0)
                                {
                                    <tr>
                                        @foreach (var item in Model.cashPrizePayouts)
                                        {
                                            <td class="text-center"><h3>@item.BalanceCount</h3></td>
                                        }

                                    </tr>
                                }
                                else
                                {
                                    <tr>
                                        <td class="text-center"><h3>$0.00</h3></td>
                                        <td class="text-center"><h3>$0.00</h3></td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>



                    <br>
                    <h3 class="title-2 m-b-25">Claims</h3>

                    <div class="card">
                        <table class="table  table-striped ">
                            <thead>
                                <tr>
                                    <th>Claimed</th>
                                    <th>Type</th>
                                    <th>Reference</th>
                                    <th nowrap="">Amount</th>
                                    <th>Status</th>
                                </tr>
                            </thead>

                            <tbody>
                                <tr>
                                    <td class="bodyblack">10/10/12</td>
                                    <td class="bodyblack">
                                        CASH
                                    </td>
                                    <td class="bodyblack">SPCA DONATION</td>


                                    <td class="bodyblack" align="right">
                                        <strong>$1.00</strong>
                                    </td>

                                    <td class="bodyblack" nowrap="">
                                        Donated.

                                    </td>
                                </tr>
                                <tr>
                                    <td class="bodyblack">02/03/11</td>


                                    <td class="bodyblack">
                                        CASH
                                    </td>
                                    <td class="bodyblack">SPCA DONATION</td>


                                    <td class="bodyblack" align="right">
                                        <strong>$1.00</strong>
                                    </td>

                                    <td class="bodyblack" nowrap="">
                                        Donated.

                                    </td>
                                </tr>
                                <tr>
                                    <td class="bodyblack">01/03/11</td>
                                    <td class="bodyblack">
                                        CASH
                                    </td>
                                    <td class="bodyblack">SPCA DONATION</td>


                                    <td class="bodyblack" align="right">
                                        <strong>$1.50</strong>
                                    </td>

                                    <td class="bodyblack" nowrap="">
                                        Donated.

                                    </td>

                                </tr>

                                <tr>
                                    <td class="bodyblack">01/03/11</td>

                                    <td class="bodyblack">
                                        CASH
                                    </td>
                                    <td class="bodyblack">SPCA DONATION</td>

                                    <td class="bodyblack" align="right">
                                        <strong>$1.50</strong>
                                    </td>

                                    <td class="bodyblack" nowrap="">
                                        Donated.

                                    </td>
                                </tr>
                                <tr>
                                    <td class="bodyblack">11/02/11</td>


                                    <td class="bodyblack">
                                        CASH
                                    </td>
                                    <td class="bodyblack">SPCA DONATION</td>


                                    <td class="bodyblack" align="right">
                                        <strong>$1.00</strong>
                                    </td>

                                    <td class="bodyblack" nowrap="">
                                        Donated.

                                    </td>

                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h3 class="title-2 m-b-25">Transactions</h3>
                    <div class="card">
                        <table class="table table-striped ">
                            <thead>
                                <tr>
                                    <th> Date </th>
                                    <th> Type </th>
                                    <th> Description </th>
                                    <th> Prize </th>
                                </tr>
                            </thead>
                            <tbody>
                                @if (Model.TransactionModelList != null)
                                {
                                    @foreach (var item in Model.TransactionModelList)
                                    {
                                        <tr>

                                            <td> @item.TransactionDatestr </td>
                                            <td> @item.TransactionType </td>
                                            <td> @item.Description </td>
                                            <td>@item.TransactionValue </td>
                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>
                    </div>


                    <h3 class="title-2 m-b-25">Booty Treasure: @Model.Treasurechestsum items</h3>
                   
                    <div class="card card-pad">
                        <div class="row justify-content-center">
                            <div class="col col-sm-2 nopadding">
                                <div class="circle-tile">
                                    <div class="circle-inner">
                                        <img src="~/BOOTY_ICONS/a.gif" class="img-fluid  rounded-circle"><h3 class="text-center"> @(Model.treasureChest == null ? 0 :Model.treasureChest.a)</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col col-sm-2 nopadding">
                                <div class="circle-tile">
                                    <div class="circle-inner">
                                        <img src="~/BOOTY_ICONS/b.gif" class="img-fluid  rounded-circle"><h3 class="text-center"> @(Model.treasureChest == null ? 0 :Model.treasureChest.b)</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col col-sm-2 nopadding">
                                <div class="circle-tile">
                                    <div class="circle-inner">
                                        <img src="~/BOOTY_ICONS/c.gif" class="img-fluid  rounded-circle"><h3 class="text-center"> @(Model.treasureChest == null ? 0 :Model.treasureChest.c)</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col col-sm-2 nopadding">
                                <div class="circle-tile">
                                    <div class="circle-inner">
                                        <img src="~/BOOTY_ICONS/d.gif" class="img-fluid  rounded-circle"><h3 class="text-center"> @(Model.treasureChest == null ? 0 :Model.treasureChest.d)</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col col-sm-2 nopadding">
                                <div class="circle-tile">
                                    <div class="circle-inner">
                                        <img src="~/BOOTY_ICONS/e.gif" class="img-fluid  rounded-circle"><h3 class="text-center"> @(Model.treasureChest == null ? 0 :Model.treasureChest.e)</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col col-sm-2 nopadding">
                                <div class="circle-tile">
                                    <div class="circle-inner">
                                        <img src="~/BOOTY_ICONS/f.gif" class="img-fluid  rounded-circle"><h3 class="text-center"> @(Model.treasureChest == null ? 0 :Model.treasureChest.f)</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col col-sm-2 nopadding">
                                <div class="circle-tile">
                                    <div class="circle-inner">
                                        <img src="~/BOOTY_ICONS/g.gif" class="img-fluid  rounded-circle"><h3 class="text-center"> @(Model.treasureChest == null ? 0 :Model.treasureChest.g)</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col col-sm-2 nopadding">
                                <div class="circle-tile">
                                    <div class="circle-inner">
                                        <img src="~/BOOTY_ICONS/h.gif" class="img-fluid  rounded-circle"><h3 class="text-center"> @(Model.treasureChest == null ? 0 :Model.treasureChest.h)</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col col-sm-2 nopadding">
                                <div class="circle-tile">
                                    <div class="circle-inner">
                                        <img src="~/BOOTY_ICONS/i.gif" class="img-fluid  rounded-circle"><h3 class="text-center"> @(Model.treasureChest == null ? 0 :Model.treasureChest.i)</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col col-sm-2 nopadding">
                                <div class="circle-tile">
                                    <div class="circle-inner">
                                        <img src="~/BOOTY_ICONS/j.gif" class="img-fluid  rounded-circle"><h3 class="text-center"> @(Model.treasureChest == null ? 0 :Model.treasureChest.j)</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col col-sm-2 nopadding">
                                <div class="circle-tile">
                                    <div class="circle-inner">
                                        <img src="~/BOOTY_ICONS/k.gif" class="img-fluid  rounded-circle"><h3 class="text-center"> @(Model.treasureChest == null ? 0 :Model.treasureChest.k)</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col col-sm-2 nopadding">
                                <div class="circle-tile">
                                    <div class="circle-inner">
                                        <img src="~/BOOTY_ICONS/l.gif" class="img-fluid  rounded-circle"><h3 class="text-center"> @(Model.treasureChest == null ? 0 :Model.treasureChest.l)</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col col-sm-2 nopadding">
                                <div class="circle-tile">
                                    <div class="circle-inner">
                                        <img src="~/BOOTY_ICONS/m.gif" class="img-fluid  rounded-circle"><h3 class="text-center"> @(Model.treasureChest == null ? 0 :Model.treasureChest.m)</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col col-sm-2 nopadding">
                                <div class="circle-tile">
                                    <div class="circle-inner">
                                        <img src="~/BOOTY_ICONS/n.gif" class="img-fluid  rounded-circle">
                                        <h3 class="text-center"> @(Model.treasureChest == null ? 0 :Model.treasureChest.n)</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col col-sm-2 nopadding">
                                <div class="circle-tile">
                                    <div class="circle-inner">
                                        <img src="~/BOOTY_ICONS/o.gif" class="img-fluid  rounded-circle">
                                        <h3 class="text-center"> @(Model.treasureChest == null ? 0 :Model.treasureChest.o)</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col col-sm-2 nopadding">
                                <div class="circle-tile">
                                    <div class="circle-inner">
                                        <img src="~/BOOTY_ICONS/p.gif" class="img-fluid  rounded-circle"><h3 class="text-center"> @(Model.treasureChest == null ? 0 :Model.treasureChest.p)</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col col-sm-2 nopadding">
                                <div class="circle-tile">
                                    <div class="circle-inner">
                                        <img src="~/BOOTY_ICONS/q.gif" class="img-fluid  rounded-circle"><h3 class="text-center"> @(Model.treasureChest == null ? 0 :Model.treasureChest.q)</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col col-sm-2 nopadding">
                                <div class="circle-tile">
                                    <div class="circle-inner">
                                        <img src="~/BOOTY_ICONS/r.gif" class="img-fluid  rounded-circle"><h3 class="text-center"> @(Model.treasureChest == null ? 0 :Model.treasureChest.r)</h3>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col col-md-6 nopadding">
                                <br> <a asp-action="ClearChest"  asp-controller="Admin" asp-route-id="@Model.PLayerId" class="text-rught btn btn-danger">Clear Entire Chest</a> 
                            </div>
                        </div>
                    </div> 
                
                </div>
            </div>
            <br />
            <div class="row">
                <div class="col-lg-12">
                    <h3 class="title-2 m-b-25">Play History</h3>
                    <div class="table-responsive table--no-card m-b-40">
                        <table class="table  table-striped table-earning table-hover ">
                            <thead>
                                <tr>
                                    <th>
                                        Date Played
                                    </th>
                                    <th>
                                        Gamecode No
                                    </th>
                                    <th>
                                        Type
                                    </th>
                                    <th>
                                        Prize Won
                                    </th>
                                    <th>
                                        Booty
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                @if (Model.WinningDetailList != null)
                                {
                                    @foreach (var item in Model.WinningDetailList)
                                    {
                                        <tr class="@((item.Result != "Free Play" && item.Result != "Not a Winning Prize")? "table-success" :"table-default" )">
                                            <td>@item.DateWonstr</td>
                                            <td>@item.GameCodeNo</td>
                                            <td>@item.RecordSourceTypestr</td>
                                            <td>@item.Result</td>
                                            <td>Booty</td>

                                        </tr>
                                    }
                                }
                            </tbody>

                        </table>
                        @if (Model.WinningDetailList == null)
                        {
                            <h3>No history available.</h3>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal" id="playerupdateEmail" tabindex="-1" role="dialog" aria-labelledby="playerupdateEmail" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Update Email</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">

                <div class="form-group">
                    <label class="col-form-label">Current Email Address</label>
                    <input type="text" id="OldEmail" disabled class="form-control">
                </div>
                <div class="form-group">
                    <label class="col-form-label">New Email Address</label>
                    <input id="NewEmail" class="form-control">
                </div>

            </div>
            <div class="modal-footer">
                <button type="button" id="closemodel" class="btn  btn-secondary" data-dismiss="modal">Close</button>
                <button class="btn btn-primary " id="updateEmail" type="submit">Save</button>
            </div>
        </div>
    </div>
</div>

@section Scripts{
    <script>
        $(document).ready(function () {
            $("#OldEmail").val($("#emailaddresss").text());
            var countryId = $('#CountryId').val();
            var statId=@Model.StateId;
            BindStateOnLoad(countryId, statId);
        });
        function BindStateOnLoad(countryId, statId) {
            $.ajax({
                url: '/Account/GetStateById',
                type: "GET",
                dataType: "JSON",
                data: { countryId: countryId },
                success: function (states) {
                    $("#StateId").html(""); // clear before appending new list

                    $.each(states, function (i, state) {
                        $("#StateId").append(
                            $('<option></option>').val(state.stateId).html(state.stateName));
                    });
                    $("#StateId").val(statId);
                }
            });
        }
        $('#CountryId').change(function () {
            var countryId = $('#CountryId').val();
            var countryName = $('#CountryId option:selected').html();
            var label = $("#StateId").siblings("label");
            if (countryId == 1)
                label.text("Region");
            else
                label.text("State");
            BindState(countryId, countryName, label.text());
        })
        function BindState(countryId, countryName, label) {
            $("#StateId").empty().append('<option selected="selected" value="0" disabled = "disabled">Loading.....</option>');
            $.ajax({
                url: '/Account/GetStateById',
                type: "GET",
                dataType: "JSON",
                data: { countryId: countryId },
                success: function (states) {
                    $("#StateId").html(""); // clear before appending new list
                    $("#StateId").append('<option selected="selected"></option>');
                    $("#StateId").append('<option  class="bg-secondary font-weight-bold " style="color:white;" disabled>--' + countryName + " " + label + 's--</option>');
                    $.each(states, function (i, state) {
                        $("#StateId").append(
                            $('<option></option>').val(state.stateId).html(state.stateName));
                    });
                }
            });
        }
    </script>
    @*Update email address *@
    <script>
        $("#openpopup").click(function () {
            $("#OldEmail").val($("#emailaddresss").text());
        });
        $("#updateEmail").click(function () {
            var datajson = {
                newemail: $("#NewEmail").val(),
                id: $("#PLayerId").val()
            }
            if (!datajson.newemail) {
                $("#NewEmail").addClass("input-validation-error");
                return;
            }
            else if (!isEmail(datajson.newemail)) {
                $("#NewEmail").addClass("input-validation-error");
                return;
            }
            $.ajax({
                url: '/Admin/UpdateEmail',
                type: "POST",
                dataType: "JSON",
                data: datajson,
                success: function (data) {
                    if (data == "Ok") {
                        $("#emailaddresss").text($("#NewEmail").val());
                        $("#NewEmail").val("");
                        $("#closemodel").click();
                        $("#alertmsg").text("Email address updated successfully");
                        $("#success-alert").fadeTo(2000, 500).slideUp(1000, function () {
                            $("#success-alert").slideUp(500);
                        });
                    }
                    if (data == "error") {
                        $("#errormsg").text("Email address already exists.");
                        $("#NewEmail").val("");
                        $("#closemodel").click();
                        $("#error-alert").fadeTo(2000, 500).slideUp(1000, function () {
                            $("#error-alert").slideUp(500);
                        });
                    }
                }
            });
        });
        function isEmail(email) {
            var regex = /^([a-zA-Z0-9_.+-])+\@@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
            return regex.test(email);
        }
    </script>
    <script>
        $("#deleteAccount").click(function () {
            var datajson = {
                playerId: $("#PLayerId").val()
            }
            $.ajax({
                url: '/Admin/DeactivateAccount',
                type: "POST",
                dataType: "JSON",
                data: datajson,
                success: function (data) {
                    if (data == "Ok") {
                        $("#alertmsg").text("Player account deactivated.");
                        $("#success-alert").fadeTo(2000, 500).slideUp(1000, function () {
                            $("#success-alert").slideUp(500);
                        });
                    }
                    if (data == "error") {
                        $("#errormsg").text("Unable to deactivate account.");
                        $("#error-alert").fadeTo(2000, 500).slideUp(1000, function () {
                            $("#error-alert").slideUp(500);
                        });
                    }
                }
            });

        })
    </script>
    <!--Generate Game Code-->SaveWebCode
    <script>
        $("#generateGameCode").click(function () {
            var gamecodecount = $("#gamecodecount").val();
            if (gamecodecount != "") {
                $.ajax({
                    url: '/Admin/GenerateGameCode',
                    type: "POST",
                    dataType: "JSON",
                    data: { number: gamecodecount },
                    success: function (data) {
                        if (data != null) {
                            SaveWebCode(data);

                        }

                        if (data == "error") {

                        }
                    }

                });
            }
            else {
                $("#errormsg-gamecode").text(" Please select webcode number!");
                $("#error-alert-gamecode").fadeTo(2000, 500).slideUp(1000, function () {
                    $("#error-alert-gamecode").slideUp(500);
                });

            }
        })
        function SaveWebCode(data) {
            var datajson = {
                webcodes: data,
                playerid: $("#PLayerId").val()
            }
            $.ajax({
                url: '/Admin/SaveWebCode',
                type: "POST",
                dataType: "JSON",
                data: datajson,
                success: function (response) {
                    if (response != null) {
                        $("#unplayedCodes").text(response.notPlayedCodeCount);
                        $("#CompGameCodesCount").text(response.compCount);
                        $("#gamecodecount").val("");
                        $("#alertmsg-gamecode").text("Gamecodes generated successfully.");
                        $("#success-alert-gamecode").fadeTo(2000, 500).slideUp(1000, function () {
                            $("#success-alert-gamecode").slideUp(500);
                        });

                    }
                    if (response == "error") {

                        $("#errormsg-gamecode").text("Error ! Something wrong");
                        $("#error-alert-gamecode").fadeTo(2000, 500).slideUp(1000, function () {
                            $("#error-alert-gamecode").slideUp(500);
                        });

                    }
                }

            });

        }
    </script>
}

